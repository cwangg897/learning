#### 파드의 문제점
- 포드는 일시적 생성한 애플리케이션의 최소단위(하나이상의 컨테이너의 집합)
- 그래서 포드가 지속적으로 생겨났을 때 서비스를 하기에 적합하지 않음
- IP주소의 지속적인 변동이나, 로드밸선싱을 관리해줄 또 다른 개체가 필요해졌음
- 이 문제를 해결하기 위해 서비스라는 리소스가 존재




#### 서비스
![image](https://github.com/cwangg897/learning/assets/79621675/161791f6-1ea8-4bee-b3a1-ad456df6ea30)
```
파드의 IP가 변경될 때마다 재설정 하지 않도록 해야함
파드 집합에서 실행중인 애플리케이션을 네트워크 서비스로 노출하는 추상화 방법이다
서비스를 기본적으로 만들면 ClusterIP라는애로 만들어진다.
기본적으로 서비스의 타입이 클러스터 IP가 된다
타입 변경하고 싶다면 로드밸런서로 적어주던가 해야한다 
```

#### 서비스의 스티키 세션
```
서비스가 다수의 포드로 구성하면 웹 서비스의 세션이 유지되지 않는다
이를 위해 처음 들어왔던 클라이언트 IP를 그대로 유지해주는 방법이 필요
```

#### yaml에서 -문법
```
s라고 붙는 복수형이 붙는 속성들 뒤쪽에는 -가 나오는데
이거는 배열의 형태를 나열할때 하는것이다
다음 - 나오기전까지 하나의 세트이다
복수형이면 리스트(-)를 의심해라
```

#### 로드밸런싱해서 외부 API호출하는경우 외부 IP설정해야한다 (기능이 있다고만 알기)
![image](https://github.com/cwangg897/learning/assets/79621675/ca81f344-a2b6-4385-80d3-94a400466a42)
![image](https://github.com/cwangg897/learning/assets/79621675/931ab7bf-4adc-49fc-98df-e43a136a4287)


#### 엔드 포인트(수동)
```
Selector가 제외된 형태 (수동형태)
필요에 따라 엔드포인트(Endpoints)를 수동으로 직접 지정해줘야 할 때가 있다. 테스트 환경과 상용 환경의 설정이 서로 다르거나, 다른 네임스페이스 또는 클러스터에 존재하는 파드와의 네트워크를 위해 서비스-서비스 간의 연결을 만들어야 하는 상황 등이 있다.
이런 경우에는 spec.selector 없이 서비스를 만들고, 해당 서비스가 가리킬 엔드포인트(Endpoints) 객체를 직접 만들어 해당 서비스에 맵핑하는 방법이 있다.
같은 클러스터가 아닌경우 수동으로해줘야하구나 


쿠버네티스의 서비스의 기능중 하나를 사용하면 외부서비스와도 연결이 가능하다
외부 서비스와 연결을 수행할 때는 서비스의 endpoint를 레이블을 사용해 지정하는 것이 아니라(레이블사용하는게아니라 도메인이용하는거임)
외부 IP를 직접 endpoint라는 별도의 자원(하나생성해야함)에서 설정해야 한다
즉 쿠버네티스의 endpoint에서 외부IP를 등록시켜서 사용해야한다는것이다

파드 셀렉터 없이 서비스를 만들어야함 그러면 엔드포인트를 위한 서비스가 하나만들어지고
따로 엔드포인트를 만들어야함 이름을 동일하게해야함
```


#### 서비스 노출(외부)하는 세 가지 방법
```
클러스터 IP의 특징 중 하나는 외부서비스가 아니라 내부의 서비스를 공유하기 위한 자원이다 외부로 노출하는게 아닌거같다
NodePort : 노드(쿠버네티스)의 자체 포트를 사용하여 파드로 리다이렉션 - 노드의 포트를 진짜 여는거임 그래서 로드밸런서랑 합체하는듯
LoadBalancer : 외부 게이트웨이를 사용해 노드 포트로 리다이렉션
NodePort, LocalBalancer는 서비스의 타입으로 보면되고 Ingress는 외부에 별도의 리소스를 만들고 리소스로 답이오면 Ingress하는 역할을 한다

Ingress : 하나의 IP주소를 통해 여러 서비스를 제공하는 특별한 메커니즘 - L7장비
용어의 구분을하는게 제일 중요하는듯 지금은 이해가안감
```

### NodePort
```yaml
apiVersion: v1

kind : Service

metadata:
  name : http-go-np
spec:
  type : NodePort
  port:
  - port: 80 # 서비스의 포트
    targetPort : 8080 # 파드의 노트
    nodePort : 30001 # 최종적으로 서비스되는 포트
  selector:
    app : http-go

# 30001으로 오면 svc역할하는곳으로 연결되고 80 -> 8080으로
# 실제로는 30001인데 SVC를 갖는 로드밸런서는 80을 가지게된다 나중에알게된다...
```
